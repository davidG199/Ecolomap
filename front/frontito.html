<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Mapa - Estación más cercana</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="shortcut icon" href="./assets/logo.png" type="image/x-icon" />
    <link rel="stylesheet" href="./styles/estilitos.css" />
    <link rel="stylesheet" href="./styles/index.css" />
    <link rel="stylesheet" href="./styles/aside.css" />
    <link rel="stylesheet" href="./styles/nav.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <!-- navbar dinamico -->
    <div class="layout">
      <nav class="top-navbar">
        <div class="nav-logo">Ecolomap</div>
        <!-- Links normales -->
        <ul class="nav-links" id="nav-links">
          <li>
            <a href="./informacionAd.html" target="_blank">Información</a>
          </li>
          <li><a href="./login.html">Login</a></li>
        </ul>
        <!-- Botón hamburguesa para mobile -->
        <div class="nav-toggle" id="nav-toggle">&#9776;</div>
      </nav>

      <!-- aside  -->
      <aside id="panel">
        <div class="panel-header">
          <h2>Ecolomap</h2>
          <p>Zonas con mayor densidad de viento en Colombia</p>
        </div>

        <div class="panel-content">
          <div id="filtros" class="panel-controls">
            <div class="control-group">
              <label for="data_option_choose">Tipo de datos:</label>
              <div class="option-group">
                <select name="data_option_choose" id="data_option_choose">
                  <option value="recent">Datos Recientes</option>
                  <option value="daily">Promedio Diario</option>
                  <option value="weekly">Promedio Semanal</option>
                </select>
              </div>
            </div>
          </div>

          <div id="info">Selecciona un punto en el mapa...</div>

          <button id="btnGraficar">Ver gráfica completa</button>
          <canvas id="grafico" style="width:100%; height:200px;"></canvas>

          <div id="prediccion">
            <h3>Predicción de ganancia</h3>
            <p>
              <strong>Velocidad promedio:</strong>
              <span id="velocidadProm">--</span> m/s
            </p>
            <p>
              <strong>Tipo de turbina:</strong>
              <span id="tipoTurbina">--</span>
            </p>
            <p>
              <strong>Producción estimada:</strong>
              <span id="produccion">--</span> kWh
            </p>
            <p>
              <strong>Ganancia estimada:</strong>
              <span id="ganancia">--</span> USD
            </p>
          </div>
        </div>

        <span class="panel-icon" id="btn-toggle-panel">
          <img src="./assets/chevron.svg" alt="chevron-icon" id="toggle-icon" />
        </span>
      </aside>

      <main class="map-container">
        <div id="mapa"></div>
      </main>
    </div>

    <!-- Logo en esquina inferior derecha -->
    <img src="./assets/logo.png" id="logo" alt="Logo" />

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="./scripts/aside.js"></script>
    <script type="module">
      // import { inicializarMapa } from "./scripts/mapita.js";
      import { obtenerEstacionMasCercana, inicializarMapa } from "./scripts/funcioncitas.js";

      window.addEventListener("DOMContentLoaded", () => {
        inicializarMapa(obtenerEstacionMasCercana);
      });

      // Menú desplegable
      const navToggle = document.getElementById("nav-toggle");
      const navLinks = document.getElementById("nav-links");

      navToggle.addEventListener("click", () => {
        navLinks.classList.toggle("active");
      });
    </script>
  </body>
</html>
